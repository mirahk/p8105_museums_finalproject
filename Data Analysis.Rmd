---
title: "Data Analysis"
output: 
  html_document:
    toc: true
    toc_float: true
---

```{r, include=FALSE}
library(tidyverse)

museum_edu_df <- read.csv("museum_edu_data.csv")
```

# Is the number of people who hold college degrees significantly related to the amount of museums in their zip code?

```{r}
# Count the number of museums per zip code
museum_count_per_zip <- museum_edu_df |>
  group_by(zip_code) |>
  summarize(n_museums = n())

# Merge the museum count back into the main dataset
museum_edu_df <- left_join(museum_edu_df, museum_count_per_zip, by = c("zip_code"), suffix = c(".museum_count_per_zip", ".museum_edu_df"))

# Linear regression: Number of Museums vs Highest Educational Attainment Category
regression_model_bach <- lm(bachelors ~ n_museums, data = museum_edu_df)

# Creating Regression Model Table
regression_model_bach |>
  broom::tidy() |>
  select(term, estimate, p.value) |>
  knitr::kable(digits=10)
```

Intercept (Estimated Constant):
The intercept is 10.39586. This is the estimated percentage of individuals with a bachelor's degree when the number of museums (n_museums) is zero. However, in practical terms, this value might not have a meaningful interpretation because it's unlikely for the number of museums to be zero in a given city.

Coefficient for n_museums:
The coefficient for n_museums is 0.17138. This represents the estimated change in the percentage of individuals with a bachelor's degree for each additional museum. The positive sign indicates a positive relationship, suggesting that, on average, as the number of museums increases, the percentage of individuals with a bachelor's degree also tends to increase.

Statistical Significance:
The associated p-value is very small (1.81e-07). This indicates that the number of museums is statistically significant in predicting the percentage of individuals with a bachelor's degree.

In summary, the results suggest a statistically significant, positive relationship between the number of museums and the percentage of individuals with a bachelor's degree.


# Is the median income significantly related to the amount of museums in a zip code?

```{r}
#Linear regression model: museums and medium income
regression_model_income <- lm(n_museums ~ median_income, data = museum_edu_df)

# Creating Regression Model Table
regression_model_income |>
  broom::tidy() |>
  select(term, estimate, p.value) |>
  knitr::kable(digits=10)
```

Intercept (Estimated Constant):

The intercept is $37,533.96. This is the predicted median income when the number of museums (n_museums) is zero. 

Coefficient for n_museums:
The coefficient for n_museums is -156.74. This represents the estimated change in median income for each additional museum. The negative sign indicates a negative relationship, suggesting that, on average, as the number of museums increases, the median income tends to decrease.

Statistical Significance:
The associated p-value is very small (2.73e-05). This indicates that the number of museums is statistically significant in predicting median income.

In summary, the results suggest a statistically significant,negative relationship between the number of museums and median income. 

# Regression Model with both Highest Educational Attainment Category and Average Income: 
## Is median income a confounder on the relationship between educational attainment and the amount of museums?
```{r}
#linear regression model testing for confounding
model3 = lm(formula = bachelors ~ median_income + n_museums, data = museum_edu_df)

# Creating Regression Model Table
model3 |>
  broom::tidy() |>
  select(term, estimate, p.value) |>
  knitr::kable(digits=10)
```

Intercept (Estimated Constant):
The intercept is -7.350. This represents the estimated percentage of individuals with a bachelor's degree when the number of museums (n_museums) is zero and median income (median_income) is zero.

Coefficient for n_museums:
The coefficient for n_museums is 0.245. his represents the estimated change in the percentage of individuals with a bachelor's degree for each additional museum, adjusted for median income. 
In the unadjusted model, the coefficient was: 0.17138. There is a 30% difference between the crude and unadjusted models, which is greater than 10%, signifying that income does infact confound the relationship between high educational attainment and amount of museums in a zipcode.
